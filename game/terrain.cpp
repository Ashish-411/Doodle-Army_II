#include "terrain.h"

void terrain::initialize()
{
	terrains = { {{89,795},{287,795},{338,795}, { 390,795 },{412,770},{427,791},{478,803},{471,952},{536,973},{611,933},{713,928},{813,943},{838,953},{925,926},{1050,932},{1089,956},{1175,923},{1297,931},
				  { 1342,959 },{1328,1015},{1003,1010},{914,1094},{768,980},{7003,1020},{637,985},{547,1060},{336,1057},{256,974},{131,1008},{92,907}},

		{{538,796},{578,799},{603,770},{640,798},{650,796},{685,766},{795,765},{807,795},{895,797},{964,733},{992,733},{993,769},{953,844},{924,863},{734,862},{701,833},{577,895},{552,855},
	{540,822}},
	{
	{1052,735},{1088,732},{1151,797},{1215,800},{1279,733},{1346,800},{1408,797},{1421,774},{1457,771},{1474,799},{1569,796},{1571,833},{1557,864},{1501,924},{1435,921},{1348,861},
	{1116,859},{1065,799},{1051,757}
},
{
{1694,800},{1791,799},{1919,669},{1984,735},{1995,711},{2034,706},{2052,733},{2111,735},{2129,706},{2155,706},{2178,733},{2208,734},{2223,763},{2261,765},{2293,797},{2387,798},{2404,764},
{2451,764},{2486,799},{2626,797},{2644,772},{2664,769},{2685,797},{2733,766},{2769,767},{2785,733},{2815,734},{2819,684},{2876,665},{2950,703},{3006,703},{3078,664},{3134,686},{3136,732},
{3170,734},{3136,895},{1695,896}
}

	};

}

void terrain::load()
{

}

void terrain::update()
{
}

void terrain::draw(sf::RenderWindow& window)
{
}

bool terrain::isOnterrain(const sf::Vector2f& playerposition,sf::Vector2f& mapOffset, const sf::View& view)
{
	sf::Vector2f newplayerposition = playerposition + mapOffset;
	for (const auto& terrain : terrains) {
		for (size_t i = 0; i < terrain.size() - 1; ++i)
		{
			sf::Vector2f start = terrain[i];
			sf::Vector2f end = terrain[i + 1];
			if (newplayerposition.x >= start.x && newplayerposition.x <= end.x) {

				float slope = (end.y - start.y) / (end.x - start.x);
				float terrainY = start.y + slope * (newplayerposition.x - start.x);

				if (newplayerposition.y >= terrainY - 2.f && newplayerposition.y <= terrainY + 2.f) {
					return true;
				}
			}
		}
	}
	return false;
}
